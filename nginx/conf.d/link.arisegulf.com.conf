server {
    listen 443 ssl http2;
    server_name link.arisegulf.com;

    # SSL certs
    ssl_certificate /etc/letsencrypt/live/link.arisegulf.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/link.arisegulf.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # Log files
    access_log /var/log/nginx/link.arisegulf.com.access.log;
    error_log /var/log/nginx/link.arisegulf.com.error.log;

    # Security headers
    add_header X-Frame-Options "SAMEORIGIN";
    add_header X-Content-Type-Options "nosniff";
    add_header Referrer-Policy "strict-origin-when-cross-origin";

    # Gzip compression
    gzip on;
    gzip_types text/plain text/css application/javascript application/json image/svg+xml;
    gzip_min_length 256;

    # --- Existing Short Links ---
    location = /airtel/rktsn/Pole-Installtion {
        set $redirect_url "https://baserow.arisegulf.com/form/397pmIxlnPNklrPt-g71bDsEl0JbRwzOR0EOXRwk1yo";
        add_header Content-Type 'text/html; charset=utf-8';
        return 200 '
<html>
<head>
    <meta charset="utf-8">
    <title>Arise | Airtel FTTH Pole Installation Submission</title>
    <meta property="og:title" content="Arise | Airtel FTTH Pole Installation Submission">
    <meta property="og:description" content="Submit your pole installation details for the Airtel FTTH project—delivered by Arise in partnership with RKTSN">
    <meta property="og:image" content="https://arisegulf.com/arise-logo.png">
    <meta property="og:url" content="https://link.arisegulf.com/airtel/rktsn/Pole-Installtion">
    <meta name="twitter:card" content="summary_large_image">
    <meta http-equiv="refresh" content="0;url=$redirect_url">
</head>
<body>
    <p>Redirecting to form...</p>
</body>
</html>';
    }

    location = /airtel/rktsn/Pole-Report {
        set $redirect_url "https://baserow.arisegulf.com/public/grid/1Of8Z89Ft-v5EvDXLjzBrab4k-bkSzbkKlXmG317nEM";
        add_header Content-Type 'text/html; charset=utf-8';
        return 200 '
<html>
<head>
    <meta charset="utf-8">
    <title>Arise | Airtel FTTH Infrastructure Database – Pole Installation Records</title>
    <meta property="og:title" content="Arise | Airtel FTTH Infrastructure Database – Pole Installation Records">
    <meta property="og:description" content="Comprehensive project documentation & visual records by Arise in partnership with RKTSN">
    <meta property="og:image" content="https://arisegulf.com/arise-logo.png">
    <meta property="og:url" content="https://link.arisegulf.com/airtel/rktsn/Pole-Report">
    <meta name="twitter:card" content="summary_large_image">
    <meta http-equiv="refresh" content="0;url=$redirect_url">
</head>
<body>
    <p>Redirecting to form...</p>
</body>
</html>';
    }

    location = /airtel/a2z/imp_mail_1109 {
        set $redirect_url "https://in.zopen.to/ZB1VHnWT3cs6cwUo27iU";
        add_header Content-Type 'text/html; charset=utf-8';
        return 200 '
<html>
<head>
    <meta charset="utf-8">
    <title>Arise | A2Z - Airtel FTTH Project</title>
    <meta property="og:title" content="Arise | A2Z - Airtel FTTH Project">
    <meta property="og:description" content="Urgent follow-up on critically outstanding payments and project status.">
    <meta property="og:image" content="https://arisegulf.com/arise-logo.png">
    <meta property="og:url" content="https://link.arisegulf.com/airtel/a2z/imp_mail_1109">
    <meta name="twitter:card" content="summary_large_image">
    <meta http-equiv="refresh" content="0;url=$redirect_url">
</head>
<body>
    <p>Redirecting to email...</p>
</body>
</html>';
    }

    location = /payment_tracker {
        set $redirect_url "https://baserow.arisegulf.com/form/OE0Id1hLCgDu8LR5QFXh1GjdcIiGGoe0P7WcN_fQH7U";
        add_header Content-Type 'text/html; charset=utf-8';
        return 200 '
<html>
<head>
    <meta charset="utf-8">
    <title>Arise | Airtel FTTH Project</title>
    <meta property="og:title" content="Arise | Airtel FTTH Project">
    <meta property="og:description" content="Submit and track payment vouchers for site expenses, labor, and materials. Part of the Arise Operations Engine.">
    <meta property="og:image" content="https://arisegulf.com/arise-logo.png">
    <meta property="og:url" content="https://link.arisegulf.com/payment_tracker">
    <meta name="twitter:card" content="summary_large_image">
</head>
<body>
    <p>Redirecting to form...</p>
    <script>window.location.href = "$redirect_url";</script>
</body>
</html>';
    }

    location = /rktsn {
        alias /usr/share/nginx/html/landing_pages/rktsn.html;
    }
    # --- End of Existing Short Links ---

    # React App in subdirectory
    location /arun_dashboard/ {
        alias /var/www/html/arun_dashboard/;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # Default fallback for unmatched URLs
    location / {
        return 404 "Short link not found.";
    }
}

# Redirect HTTP to HTTPS
server {
    listen 80;
    server_name link.arisegulf.com;
    return 301 https://$host$request_uri;
}
